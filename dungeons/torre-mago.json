{
  "id": "torre-dos-magos",
  "name": "Torre dos Magos",
  "description": "Uma torre antiga que já foi o lar de uma ordem de magos poderosos. Agora está abandonada, mas ainda guarda muitos segredos e perigos.",
  "entrance": "room-1",
  "decorativeBlocks": [
    { "type": "corridor", "gridX": 10, "gridY": 18, "gridWidth": 1, "gridHeight": 1 },
    { "type": "corridor", "gridX": 10, "gridY": 17, "gridWidth": 1, "gridHeight": 1 },
    { "type": "corridor", "gridX": 10, "gridY": 16, "gridWidth": 1, "gridHeight": 1 },
    { "type": "corridor", "gridX": 10, "gridY": 15, "gridWidth": 1, "gridHeight": 1 },
    { "type": "corridor", "gridX": 10, "gridY": 14, "gridWidth": 1, "gridHeight": 1 },
    { "type": "corridor", "gridX": 10, "gridY": 13, "gridWidth": 1, "gridHeight": 1 },
    { "type": "corridor", "gridX": 10, "gridY": 12, "gridWidth": 1, "gridHeight": 1 },
    { "type": "corridor", "gridX": 10, "gridY": 11, "gridWidth": 1, "gridHeight": 1 },
    { "type": "corridor", "gridX": 10, "gridY": 10, "gridWidth": 1, "gridHeight": 1 },
    { "type": "corridor", "gridX": 10, "gridY": 9, "gridWidth": 1, "gridHeight": 1 },
    { "type": "corridor", "gridX": 10, "gridY": 8, "gridWidth": 1, "gridHeight": 1 },
    { "type": "corridor", "gridX": 10, "gridY": 7, "gridWidth": 1, "gridHeight": 1 },
    { "type": "corridor", "gridX": 10, "gridY": 6, "gridWidth": 1, "gridHeight": 1 },
    { "type": "corridor", "gridX": 10, "gridY": 5, "gridWidth": 1, "gridHeight": 1 }
  ],
  "rooms": {
    "room-1": {
      "id": "room-1",
      "name": "Entrada da Torre",
      "description": "Um saguão amplo com piso de mármore rachado. Pilares ornamentados sustentam o teto alto. Uma escadaria em espiral sobe para o próximo andar.",
      "type": "room",
      "gridX": 8,
      "gridY": 18,
      "gridWidth": 5,
      "gridHeight": 5,
      "exits": [
        { "direction": "north", "leadsTo": "room-2", "type": "door", "locked": false }
      ],
      "events": [
        { "type": "first-visit", "text": "Você adentra a Torre dos Magos. O ar está carregado de energia mágica residual, e você sente um leve formigamento na pele." }
      ],
      "exploration": {
        "states": {
          "initial": {
            "examined": false,
            "pillarExamined": false,
            "floorExamined": false,
            "statueExamined": false,
            "luckTestCompleted": false,
            "skillTestCompleted": false,
            "charismaTestCompleted": false,
            "mechanismActivated": false,
            "mechanismFailed": false
          }
        },
        "examine": [
          {
            "condition": "!states.examined",
            "text": "Você observa o saguão da torre. O piso de mármore está rachado em vários lugares, e os pilares ornamentados mostram sinais de desgaste. No centro do saguão, há uma estátua de um mago segurando um livro. O que você deseja examinar mais de perto?",
            "effect": {"states.examined": true},
            "pointsOfInterest": [
              {
                "id": "pilares",
                "name": "Pilares Ornamentados",
                "description": "Os pilares são feitos de mármore branco com veios dourados. Estão entalhados com símbolos arcanos que parecem brilhar levemente quando você os observa por muito tempo."
              },
              {
                "id": "piso",
                "name": "Piso Rachado",
                "description": "O piso de mármore está rachado em vários lugares. Algumas rachaduras formam padrões que parecem quase intencionais, como se fossem parte de um grande círculo mágico.",
                "effect": {"states.floorExamined": true}
              },
              {
                "id": "estatua",
                "name": "Estátua do Mago",
                "description": "A estátua representa um mago idoso com barba longa, vestindo uma túnica com símbolos estelares. Ele segura um livro aberto em suas mãos. Na base da estátua, há uma inscrição: 'O conhecimento é poder, mas a sabedoria é saber quando usá-lo.'",
                "effect": {"states.statueExamined": true}
              }
            ]
          },
          {
            "condition": "states.examined",
            "text": "O que você deseja examinar no saguão?",
            "pointsOfInterest": [
              {
                "id": "pilares",
                "name": "Pilares Ornamentados",
                "description": "Os pilares são feitos de mármore branco com veios dourados. Estão entalhados com símbolos arcanos que parecem brilhar levemente quando você os observa por muito tempo.",
                "effect": {"states.pillarExamined": true}
              },
              {
                "id": "piso",
                "name": "Piso Rachado",
                "description": "O piso de mármore está rachado em vários lugares. Algumas rachaduras formam padrões que parecem quase intencionais, como se fossem parte de um grande círculo mágico.",
                "effect": {"states.floorExamined": true}
              },
              {
                "id": "estatua",
                "name": "Estátua do Mago",
                "description": "A estátua representa um mago idoso com barba longa, vestindo uma túnica com símbolos estelares. Ele segura um livro aberto em suas mãos. Na base da estátua, há uma inscrição: 'O conhecimento é poder, mas a sabedoria é saber quando usá-lo.'",
                "effect": {"states.statueExamined": true}
              }
            ]
          }
        ],
        "search": [
          {
            "condition": "states.statueExamined",
            "text": "Você procura cuidadosamente ao redor da estátua e nota que o livro nas mãos do mago tem páginas que podem ser viradas. Ao folhear o livro de pedra, você encontra uma pequena moeda de ouro escondida entre as páginas.",
            "chance": 1.0,
            "items": [
              {
                "id": "moeda-ouro",
                "content": "Moeda de Ouro Antiga",
                "description": "Uma moeda de ouro antiga com o símbolo de uma torre em um lado e uma estrela no outro.",
                "quantity": 1,
                "value": 10
              }
            ]
          },
          {
            "condition": "states.pillarExamined && states.floorExamined",
            "text": "Ao examinar mais atentamente as rachaduras no piso próximo aos pilares, você percebe que uma das lajes está solta. Ao movê-la, você descobre um pequeno compartimento contendo um pergaminho.",
            "chance": 0.8,
            "items": [
              {
                "id": "pergaminho-protecao",
                "content": "Pergaminho de Proteção",
                "description": "Um pergaminho com um encantamento de proteção contra fogo.",
                "consumable": true,
                "effect": "fire_protection"
              }
            ]
          },
          {
            "condition": "!states.statueExamined && !states.pillarExamined",
            "text": "Você procura pela sala, mas não encontra nada de interesse.",
            "chance": 1.0,
            "results": []
          }
        ],
        "interactions": [
          {
            "id": "teste-sorte",
            "name": "Testar Sorte com Pedra Instável",
            "condition": "!states.luckTestCompleted",
            "description": "Você nota uma pedra instável no teto, logo acima de um pequeno pedestal com uma gema brilhante. A pedra parece que pode cair a qualquer momento.",
            "result": {
              "text": "Você decide arriscar e tentar pegar a gema antes que a pedra caia.",
              "action": "testLuck",
              "luckTest": {
                "description": "Você precisa testar sua sorte para pegar a gema antes que a pedra caia.",
                "success": {
                  "text": "Com um movimento rápido, você consegue pegar a gema e se afastar antes que a pedra caia estrondosamente no chão!",
                  "effect": {"states.luckTestCompleted": true},
                  "items": [
                    {
                      "id": "gema-brilhante",
                      "content": "Gema Arcana",
                      "description": "Uma gema azul que pulsa com energia mágica.",
                      "value": 50
                    }
                  ]
                },
                "failure": {
                  "text": "Você tenta pegar a gema, mas a pedra se solta e cai antes que você consiga se afastar!",
                  "effect": {"states.luckTestCompleted": true},
                  "damage": {
                    "amount": "2D6",
                    "message": "A pedra atinge você com força!"
                  }
                }
              }
            }
          },
          {
            "id": "teste-habilidade",
            "name": "Decifrar Símbolos Arcanos",
            "condition": "states.pillarExamined && !states.skillTestCompleted",
            "description": "Os símbolos arcanos nos pilares parecem formar algum tipo de código ou mensagem. Talvez você consiga decifrá-los com sua habilidade.",
            "result": {
              "text": "Você tenta decifrar os símbolos arcanos nos pilares...",
              "action": "testSkill",
              "skillTest": {
                "description": "Você precisa usar sua habilidade para decifrar os símbolos arcanos.",
                "difficulty": 15,
                "success": {
                  "text": "Após alguns minutos de estudo, você consegue decifrar os símbolos! Eles revelam a localização de um compartimento secreto em um dos pilares. Dentro dele, você encontra um pequeno frasco.",
                  "effect": {"states.skillTestCompleted": true},
                  "items": [
                    {
                      "id": "pocao-mana",
                      "content": "Poção de Mana",
                      "description": "Um frasco contendo um líquido azul brilhante que restaura energia mágica.",
                      "consumable": true,
                      "effect": "restore_mana",
                      "value": 25
                    }
                  ]
                },
                "failure": {
                  "text": "Você tenta decifrar os símbolos, mas eles são complexos demais para seu conhecimento atual. Talvez com mais estudo...",
                  "effect": {"states.skillTestCompleted": true}
                }
              }
            }
          },
          {
            "id": "teste-carisma",
            "name": "Comunicar com Espírito do Mago",
            "condition": "states.statueExamined && !states.charismaTestCompleted",
            "description": "Você sente uma presença etérea ao redor da estátua do mago. Talvez seja possível estabelecer algum tipo de comunicação.",
            "result": {
              "text": "Você tenta se comunicar com o espírito do mago que parece habitar a estátua...",
              "action": "testCharisma",
              "charismaTest": {
                "description": "Você tenta estabelecer uma conexão com a presença espiritual usando seu carisma.",
                "difficulty": 18,
                "success": {
                  "text": "Surpreendentemente, uma voz etérea responde à sua tentativa de comunicação! 'Bem-vindo, buscador de conhecimento. Poucos conseguem me ouvir. Como recompensa por sua sensibilidade, deixo-lhe este conselho: Na biblioteca, procure pelo livro que não tem título, mas tem todas as respostas.' O espírito então desaparece.",
                  "effect": {"states.charismaTestCompleted": true, "states.receivedMagoTip": true}
                },
                "failure": {
                  "text": "Você tenta se comunicar, mas não recebe nenhuma resposta. Apenas o silêncio da torre abandonada.",
                  "effect": {"states.charismaTestCompleted": true}
                }
              }
            }
          },
          {
            "id": "mecanismo-antigo",
            "name": "Ativar Mecanismo Antigo",
            "condition": "states.floorExamined && !states.mechanismActivated",
            "description": "Entre as rachaduras do piso, você nota um padrão circular que parece ser um mecanismo antigo. Há uma série de símbolos que precisam ser alinhados na sequência correta para ativá-lo.",
            "result": {
              "text": "Você tenta decifrar a sequência correta para ativar o mecanismo...",
              "action": "testSkill",
              "skillTest": {
                "description": "O mecanismo é complexo e requer precisão e conhecimento arcano para ser ativado. Você precisa alinhar os símbolos na sequência correta.",
                "difficulty": 17,
                "success": {
                  "text": "Com habilidade e precisão, você consegue alinhar os símbolos na sequência correta! O mecanismo emite um suave clique e o chão treme levemente. Uma seção do piso desliza para o lado, revelando um compartimento secreto contendo um amuleto antigo.",
                  "effect": {"states.mechanismActivated": true},
                  "items": [
                    {
                      "id": "amuleto-protetor",
                      "content": "Amuleto Protetor",
                      "description": "Um amuleto de prata com uma pedra azul no centro. Quando usado, oferece proteção contra magias hostis.",
                      "wearable": true,
                      "effect": "magic_protection",
                      "value": 75
                    }
                  ]
                },
                "failure": {
                  "text": "Você tenta alinhar os símbolos, mas a sequência parece muito complexa. Subitamente, o mecanismo emite um som agudo e uma pequena explosão de energia arcana é liberada!",
                  "effect": {"states.mechanismActivated": true, "states.mechanismFailed": true},
                  "damage": {
                    "amount": "1D8",
                    "type": "magic",
                    "message": "Uma explosão de energia arcana atinge você!"
                  }
                }
              }
            }
          }
        ]
      }
    },
    "room-2": {
      "id": "room-2",
      "name": "Biblioteca Abandonada",
      "description": "Uma vasta biblioteca com estantes altas cheias de livros empoeirados. Muitos tomos estão espalhados pelo chão.",
      "type": "room",
      "gridX": 8,
      "gridY": 12,
      "gridWidth": 5,
      "gridHeight": 5,
      "exits": [
        { "direction": "south", "leadsTo": "room-1", "type": "door", "locked": false },
        { "direction": "east", "leadsTo": "room-3", "type": "door", "locked": true, "keyId": "key-biblioteca" },
        { "direction": "north", "leadsTo": "room-4", "type": "door", "locked": false }
      ],
      "events": [
        { "type": "first-visit", "text": "Ao entrar na biblioteca, você é recebido por uma nuvem de poeira. Os livros parecem ter sido deixados às pressas, com alguns ainda abertos sobre as mesas." }
      ],
      "exploration": {
        "states": {
          "initial": {
            "examined": false,
            "estantesExamined": false,
            "mesaExamined": false,
            "livroVermelhoExamined": false,
            "keyFound": false,
            "keyCollected": false,
            "trapTriggered": false
          }
        },
        "examine": [
          {
            "condition": "!states.examined",
            "text": "Você observa a biblioteca abandonada. As estantes estão cheias de livros sobre magia, alquimia e história arcana. Há uma mesa de estudo no centro da sala com vários livros abertos. O que você deseja examinar mais de perto?",
            "effect": {"states.examined": true},
            "pointsOfInterest": [
              {
                "id": "estantes",
                "name": "Estantes de Livros",
                "description": "As estantes de madeira escura estão cheias de livros antigos. Muitos têm títulos em línguas que você não reconhece, mas alguns são sobre história da magia, alquimia e invocação de elementais."
              },
              {
                "id": "mesa",
                "name": "Mesa de Estudo",
                "description": "Uma grande mesa de carvalho com vários livros abertos. Parece que alguém estava estudando aqui antes de partir às pressas. Entre os livros abertos, um em particular chama sua atenção - um tomo encadernado em couro vermelho com símbolos dourados.",
                "effect": {"states.mesaExamined": true}
              },
              {
                "id": "livro-vermelho",
                "name": "Livro de Capa Vermelha",
                "condition": "states.mesaExamined",
                "description": "Você examina o livro de capa vermelha. Ele contém diagramas complexos de círculos mágicos e fórmulas arcanas. Uma página está marcada com um pedaço de pergaminho. Ao virar a página marcada, você nota que há algo escondido na encadernação do livro.",
                "effect": {"states.livroVermelhoExamined": true}
              }
            ]
          },
          {
            "condition": "states.examined",
            "text": "O que você deseja examinar na biblioteca?",
            "pointsOfInterest": [
              {
                "id": "estantes",
                "name": "Estantes de Livros",
                "description": "As estantes de madeira escura estão cheias de livros antigos. Muitos têm títulos em línguas que você não reconhece, mas alguns são sobre história da magia, alquimia e invocação de elementais.",
                "effect": {"states.estantesExamined": true}
              },
              {
                "id": "mesa",
                "name": "Mesa de Estudo",
                "description": "Uma grande mesa de carvalho com vários livros abertos. Parece que alguém estava estudando aqui antes de partir às pressas. Entre os livros abertos, um em particular chama sua atenção - um tomo encadernado em couro vermelho com símbolos dourados.",
                "effect": {"states.mesaExamined": true}
              },
              {
                "id": "livro-vermelho",
                "name": "Livro de Capa Vermelha",
                "condition": "states.mesaExamined",
                "description": "Você examina o livro de capa vermelha. Ele contém diagramas complexos de círculos mágicos e fórmulas arcanas. Uma página está marcada com um pedaço de pergaminho. Ao virar a página marcada, você nota que há algo escondido na encadernação do livro.",
                "effect": {"states.livroVermelhoExamined": true}
              }
            ]
          }
        ],
        "search": [
          {
            "condition": "states.livroVermelhoExamined && !states.keyFound && !states.trapTriggered",
            "text": "Você procura entre as páginas do livro marcado e encontra uma pequena chave de prata escondida dentro da encadernação. No entanto, ao remover a chave, você aciona um mecanismo mágico de proteção!",
            "effect": {"states.keyFound": true, "states.trapTriggered": true},
            "items": [
              {
                "id": "key-biblioteca",
                "content": "Chave de Prata",
                "description": "Uma pequena chave de prata com símbolos arcanos gravados."
              }
            ],
            "damage": {
              "amount": "1D6",
              "type": "magic",
              "message": "Um raio de energia mágica dispara do livro, atingindo você no peito!"
            }
          },
          {
            "condition": "states.keyFound && !states.keyCollected",
            "text": "Você já encontrou a chave de prata escondida no livro.",
            "items": [
              {
                "id": "key-biblioteca",
                "content": "Chave de Prata",
                "description": "Uma pequena chave de prata com símbolos arcanos gravados."
              }
            ]
          },
          {
            "condition": "states.estantesExamined",
            "text": "Você procura entre os livros nas estantes e encontra um pequeno frasco de poção escondido atrás de alguns tomos.",
            "chance": 0.7,
            "items": [
              {
                "id": "pocao-cura",
                "content": "Poção de Cura",
                "description": "Um frasco contendo um líquido vermelho brilhante que restaura energia vital.",
                "consumable": true,
                "effect": "healing",
                "value": 15
              }
            ]
          },
          {
            "condition": "!states.livroVermelhoExamined && !states.estantesExamined",
            "text": "Você procura pela biblioteca, mas não encontra nada de interesse.",
            "chance": 1.0,
            "results": []
          }
        ]
      }
    }
  }
}
